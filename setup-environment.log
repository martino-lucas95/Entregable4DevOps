[0;32m[2025-11-24 22:35:15][0m ==========================================
[0;32m[2025-11-24 22:35:15][0m Inicializaci√≥n del Entorno Completo
[0;32m[2025-11-24 22:35:15][0m ==========================================
[0;32m[2025-11-24 22:35:15][0m 
[0;32m[2025-11-24 22:35:15][0m Verificando prerequisitos...
[0;32m[2025-11-24 22:35:15][0m ‚úì Todos los prerequisitos est√°n disponibles
[0;32m[2025-11-24 22:35:15][0m === Instalando Operadores de Kubernetes ===
[0;32m[2025-11-24 22:35:15][0m No se requieren operadores adicionales (usando deployments directos)
[0;32m[2025-11-24 22:35:15][0m ‚úì Operadores verificados
[0;32m[2025-11-24 22:35:15][0m === Construyendo Im√°genes Docker ===
[0;32m[2025-11-24 22:35:15][0m Construyendo imagen del backend...
[0;32m[2025-11-24 22:35:15][0m Construyendo imagen del frontend...
[0;32m[2025-11-24 22:35:15][0m ‚úì Im√°genes construidas exitosamente
[0;32m[2025-11-24 22:35:37][0m ==========================================
[0;32m[2025-11-24 22:35:37][0m Inicializaci√≥n del Entorno Completo
[0;32m[2025-11-24 22:35:37][0m ==========================================
[0;32m[2025-11-24 22:35:37][0m 
[0;32m[2025-11-24 22:35:37][0m Verificando prerequisitos...
[0;32m[2025-11-24 22:35:37][0m ‚úì Todos los prerequisitos est√°n disponibles
[0;32m[2025-11-24 22:35:37][0m === Instalando Operadores de Kubernetes ===
[0;32m[2025-11-24 22:35:37][0m No se requieren operadores adicionales (usando deployments directos)
[0;32m[2025-11-24 22:35:37][0m ‚úì Operadores verificados
[0;32m[2025-11-24 22:35:37][0m === Construyendo Im√°genes Docker ===
[0;32m[2025-11-24 22:35:37][0m Construyendo imagen del backend...
[0;32m[2025-11-24 22:35:37][0m Construyendo imagen del frontend...
[0;32m[2025-11-24 22:35:37][0m ‚úì Im√°genes construidas exitosamente
[0;34m[2025-11-24 22:35:37] INFO:[0m Im√°genes disponibles:
entregable4devops-frontend           1.0         e286e735db5a   About an hour ago   147MB
entregable4devops-backend            1.0         46863da50364   About an hour ago   951MB
[0;32m[2025-11-24 22:35:37][0m === Instalando Kyverno ===
=== Instalaci√≥n de Kyverno ===

[1/4] Verificando conexi√≥n al cluster de Kubernetes...
‚úì Conexi√≥n al cluster verificada

[2/4] Agregando repositorio de Helm de Kyverno...
Repositorio de Kyverno ya existe, actualizando...
Hang tight while we grab the latest from your chart repositories...
...Successfully got an update from the "kyverno" chart repository
Update Complete. ‚éàHappy Helming!‚éà
‚úì Repositorio de Kyverno agregado y actualizado

[3/4] Verificando si Kyverno ya est√° instalado...
ADVERTENCIA: El namespace 'kyverno' ya existe
[1;33m[2025-11-24 22:35:37] WARNING:[0m Kyverno puede estar ya instalado o hubo un error
[0;32m[2025-11-24 22:35:37][0m ‚úì Kyverno instalado/verificado
[0;32m[2025-11-24 22:35:37][0m === Aplicando Pol√≠ticas de Kyverno ===
=== Aplicando Pol√≠ticas de Kyverno ===

[1/3] Verificando que Kyverno est√© instalado...
ADVERTENCIA: Los pods de Kyverno no est√°n listos. Continuando de todas formas...

[2/3] Aplicando pol√≠ticas de Kyverno...
  Aplicando: disallow-latest-tag.yaml
Warning: Validation failure actions enforce/audit are deprecated, use Enforce/Audit instead.
clusterpolicy.kyverno.io/disallow-latest-tag configured
  Aplicando: disallow-root-containers.yaml
Warning: Validation failure actions enforce/audit are deprecated, use Enforce/Audit instead.
clusterpolicy.kyverno.io/disallow-root-containers configured
  Aplicando: falco-policy-exception.yaml
policyexception.kyverno.io/falco-exception unchanged
  Aplicando: require-labels.yaml
Warning: Validation failure actions enforce/audit are deprecated, use Enforce/Audit instead.
clusterpolicy.kyverno.io/require-labels configured
  Aplicando: require-resource-limits.yaml
Warning: Validation failure actions enforce/audit are deprecated, use Enforce/Audit instead.
clusterpolicy.kyverno.io/require-resource-limits configured

[3/3] Verificando pol√≠ticas aplicadas...

Pol√≠ticas ClusterPolicy instaladas:
NAME                       ADMISSION   BACKGROUND   READY   AGE   MESSAGE
disallow-latest-tag        true        true         True    84m   Ready
disallow-root-containers   true        true         True    84m   Ready
require-labels             true        true         True    84m   Ready
require-resource-limits    true        true         True    84m   Ready

‚úì Pol√≠ticas aplicadas exitosamente!

Para ver detalles de una pol√≠tica:
  kubectl describe clusterpolicy <nombre-politica>

Para ver eventos de pol√≠ticas:
  kubectl get events -n kyverno --sort-by='.lastTimestamp'
[0;32m[2025-11-24 22:35:37][0m ‚úì Pol√≠ticas de Kyverno aplicadas
[0;32m[2025-11-24 22:35:37][0m === Instalando Falco ===
=== Instalaci√≥n de Falco ===

[1/4] Verificando conexi√≥n al cluster de Kubernetes...
‚úì Conexi√≥n al cluster verificada

[2/4] Agregando repositorio de Helm de Falco...
Repositorio de Falco ya existe, actualizando...
Hang tight while we grab the latest from your chart repositories...
...Successfully got an update from the "falcosecurity" chart repository
Update Complete. ‚éàHappy Helming!‚éà
‚úì Repositorio de Falco agregado y actualizado

[3/4] Verificando si Falco ya est√° instalado...
ADVERTENCIA: El namespace 'falco' ya existe


[4/4] Instalando Falco...
Usando valores personalizados desde falco-values.yaml
level=WARN msg="unable to find exact version; falling back to closest available version" chart=falco requested="" selected=7.0.1
level=INFO msg="WARN upgrade failed name=falco error=\"conflict occurred while applying object falco/falco apps/v1, Kind=DaemonSet: Apply failed with 2 conflicts: conflicts with \\\"helm\\\" using apps/v1:\\n- .spec.template.spec.containers[name=\\\"falco\\\"].env[name=\\\"FALCO_HOSTNAME\\\"].valueFrom.fieldRef\\n- .spec.template.spec.containers[name=\\\"falco\\\"].env[name=\\\"FALCO_K8S_NODE_NAME\\\"].valueFrom.fieldRef\""
Error: UPGRADE FAILED: conflict occurred while applying object falco/falco apps/v1, Kind=DaemonSet: Apply failed with 2 conflicts: conflicts with "helm" using apps/v1:
- .spec.template.spec.containers[name="falco"].env[name="FALCO_HOSTNAME"].valueFrom.fieldRef
- .spec.template.spec.containers[name="falco"].env[name="FALCO_K8S_NODE_NAME"].valueFrom.fieldRef
[1;33m[2025-11-24 22:35:37] WARNING:[0m Falco puede estar ya instalado o hubo un error
[0;32m[2025-11-24 22:35:37][0m ‚úì Falco instalado/verificado
[0;32m[2025-11-24 22:35:37][0m === Desplegando Aplicaci√≥n con Helm ===
namespace/development created
[0;32m[2025-11-24 22:35:37][0m Actualizando dependencias de Helm...
[0;32m[2025-11-24 22:35:37][0m Desplegando aplicaci√≥n en namespace: development
Release "stock-management" does not exist. Installing it now.
[0;32m[2025-11-24 22:44:13][0m ==========================================
[0;32m[2025-11-24 22:44:13][0m Inicializaci√≥n del Entorno Completo
[0;32m[2025-11-24 22:44:13][0m ==========================================
[0;32m[2025-11-24 22:44:13][0m 
[0;32m[2025-11-24 22:44:13][0m Verificando prerequisitos...
[0;32m[2025-11-24 22:44:13][0m ‚úì Todos los prerequisitos est√°n disponibles
[0;32m[2025-11-24 22:44:13][0m === Instalando Operadores de Kubernetes ===
[0;32m[2025-11-24 22:44:13][0m No se requieren operadores adicionales (usando deployments directos)
[0;32m[2025-11-24 22:44:13][0m ‚úì Operadores verificados
[0;32m[2025-11-24 22:44:13][0m === Construyendo Im√°genes Docker ===
[0;32m[2025-11-24 22:44:13][0m Construyendo imagen del backend...
[0;32m[2025-11-24 22:44:13][0m Construyendo imagen del frontend...
[0;32m[2025-11-24 22:44:13][0m ‚úì Im√°genes construidas exitosamente
[0;34m[2025-11-24 22:44:13] INFO:[0m Im√°genes disponibles:
entregable4devops-frontend           1.0         e286e735db5a   About an hour ago   147MB
entregable4devops-backend            1.0         46863da50364   About an hour ago   951MB
[0;32m[2025-11-24 22:44:13][0m === Instalando Kyverno ===
=== Instalaci√≥n de Kyverno ===

[1/4] Verificando conexi√≥n al cluster de Kubernetes...
‚úì Conexi√≥n al cluster verificada

[2/4] Agregando repositorio de Helm de Kyverno...
Repositorio de Kyverno ya existe, actualizando...
Hang tight while we grab the latest from your chart repositories...
...Successfully got an update from the "kyverno" chart repository
Update Complete. ‚éàHappy Helming!‚éà
‚úì Repositorio de Kyverno agregado y actualizado

[3/4] Verificando si Kyverno ya est√° instalado...
ADVERTENCIA: El namespace 'kyverno' ya existe
[1;33m[2025-11-24 22:44:13] WARNING:[0m Kyverno puede estar ya instalado o hubo un error
[0;32m[2025-11-24 22:44:13][0m ‚úì Kyverno instalado/verificado
[0;32m[2025-11-24 22:44:13][0m === Aplicando Pol√≠ticas de Kyverno ===
=== Aplicando Pol√≠ticas de Kyverno ===

[1/3] Verificando que Kyverno est√© instalado...
ADVERTENCIA: Los pods de Kyverno no est√°n listos. Continuando de todas formas...

[2/3] Aplicando pol√≠ticas de Kyverno...
  Aplicando: disallow-latest-tag.yaml
Warning: Validation failure actions enforce/audit are deprecated, use Enforce/Audit instead.
clusterpolicy.kyverno.io/disallow-latest-tag configured
  Aplicando: disallow-root-containers.yaml
Warning: Validation failure actions enforce/audit are deprecated, use Enforce/Audit instead.
clusterpolicy.kyverno.io/disallow-root-containers configured
  Aplicando: falco-policy-exception.yaml
policyexception.kyverno.io/falco-exception unchanged
  Aplicando: require-labels.yaml
Warning: Validation failure actions enforce/audit are deprecated, use Enforce/Audit instead.
clusterpolicy.kyverno.io/require-labels configured
  Aplicando: require-resource-limits.yaml
Warning: Validation failure actions enforce/audit are deprecated, use Enforce/Audit instead.
clusterpolicy.kyverno.io/require-resource-limits configured

[3/3] Verificando pol√≠ticas aplicadas...

Pol√≠ticas ClusterPolicy instaladas:
NAME                       ADMISSION   BACKGROUND   READY   AGE   MESSAGE
disallow-latest-tag        true        true         True    93m   Ready
disallow-root-containers   true        true         True    93m   Ready
require-labels             true        true         True    93m   Ready
require-resource-limits    true        true         True    93m   Ready

‚úì Pol√≠ticas aplicadas exitosamente!

Para ver detalles de una pol√≠tica:
  kubectl describe clusterpolicy <nombre-politica>

Para ver eventos de pol√≠ticas:
  kubectl get events -n kyverno --sort-by='.lastTimestamp'
[0;32m[2025-11-24 22:44:13][0m ‚úì Pol√≠ticas de Kyverno aplicadas
[0;32m[2025-11-24 22:44:13][0m === Instalando Falco ===
=== Instalaci√≥n de Falco ===

[1/4] Verificando conexi√≥n al cluster de Kubernetes...
‚úì Conexi√≥n al cluster verificada

[2/4] Agregando repositorio de Helm de Falco...
Repositorio de Falco ya existe, actualizando...
Hang tight while we grab the latest from your chart repositories...
...Successfully got an update from the "falcosecurity" chart repository
Update Complete. ‚éàHappy Helming!‚éà
‚úì Repositorio de Falco agregado y actualizado

[3/4] Verificando si Falco ya est√° instalado...
ADVERTENCIA: El namespace 'falco' ya existe


[4/4] Instalando Falco...
Usando valores personalizados desde falco-values.yaml
level=WARN msg="unable to find exact version; falling back to closest available version" chart=falco requested="" selected=7.0.1
level=INFO msg="WARN upgrade failed name=falco error=\"conflict occurred while applying object falco/falco apps/v1, Kind=DaemonSet: Apply failed with 2 conflicts: conflicts with \\\"helm\\\" using apps/v1:\\n- .spec.template.spec.containers[name=\\\"falco\\\"].env[name=\\\"FALCO_HOSTNAME\\\"].valueFrom.fieldRef\\n- .spec.template.spec.containers[name=\\\"falco\\\"].env[name=\\\"FALCO_K8S_NODE_NAME\\\"].valueFrom.fieldRef\""
Error: UPGRADE FAILED: conflict occurred while applying object falco/falco apps/v1, Kind=DaemonSet: Apply failed with 2 conflicts: conflicts with "helm" using apps/v1:
- .spec.template.spec.containers[name="falco"].env[name="FALCO_HOSTNAME"].valueFrom.fieldRef
- .spec.template.spec.containers[name="falco"].env[name="FALCO_K8S_NODE_NAME"].valueFrom.fieldRef
[1;33m[2025-11-24 22:44:13] WARNING:[0m Falco puede estar ya instalado o hubo un error
[0;32m[2025-11-24 22:44:13][0m ‚úì Falco instalado/verificado
[0;32m[2025-11-24 22:44:13][0m === Desplegando Aplicaci√≥n con Helm ===
namespace/test created
[0;32m[2025-11-24 22:44:13][0m Actualizando dependencias de Helm...
[0;32m[2025-11-24 22:44:13][0m Desplegando aplicaci√≥n en namespace: test
Release "stock-management" does not exist. Installing it now.
Error: unable to continue with install: ClusterRole "stock-management-prometheus" in namespace "" exists and cannot be imported into the current release: invalid ownership metadata; annotation validation error: key "meta.helm.sh/release-namespace" must equal "test": current value is "development"
[0;31m[2025-11-24 22:44:13] ERROR:[0m Error al desplegar la aplicaci√≥n
Error: resource not ready, name: stock-management-backend, kind: Deployment, status: InProgress
resource not ready, name: stock-management-frontend, kind: Deployment, status: InProgress
context deadline exceeded
[0;31m[2025-11-24 22:35:37] ERROR:[0m Error al desplegar la aplicaci√≥n
